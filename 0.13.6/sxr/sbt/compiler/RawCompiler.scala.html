<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>sbt/compiler/RawCompiler.scala</title>
        <script type="text/javascript" src="../../jquery-all.js"></script>
        <script type="text/javascript" src="../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/* sbt -- Simple Build Tool
 * Copyright 2009, 2010  Mark Harrah
 */</span>
<span class="keyword">package</span> sbt
<span class="keyword">package</span> compiler

<span class="keyword">import</span> java.io.File

<span class="comment">/**
 * A basic interface to the compiler.  It is called in the same virtual machine, but no dependency analysis is done.  This
 * is used, for example, to compile the interface/plugin code.
 * If `explicitClasspath` is true, the bootclasspath and classpath are not augmented.  If it is false,
 * the scala-library.jar from `scalaInstance` is put on bootclasspath and the scala-compiler jar goes on the classpath.
 */</span>
<span class="keyword">class</span> <a title="class RawCompiler extends AnyRef" id="sbt.compiler;RawCompiler">RawCompiler</a><a href="#sbt.compiler;RawCompiler" title="sbt.compiler.RawCompiler" class="delimiter">(</a><span class="keyword">val</span> <a title="xsbti.compile.ScalaInstance" id="sbt.compiler;RawCompiler.scalaInstance">scalaInstance</a>: xsbti.compile.<a href="../../xsbti/compile/ScalaInstance.java.html#xsbti.compile;ScalaInstance" title="xsbti.compile.ScalaInstance">ScalaInstance</a>, <a title="sbt.ClasspathOptions" id="sbt.compiler;RawCompiler.cp">cp</a>: <a href="../ClasspathOptions.scala.html#sbt;ClasspathOptions" title="sbt.ClasspathOptions">ClasspathOptions</a>, <a title="sbt.Logger" id="sbt.compiler;RawCompiler.log">log</a>: <a href="../Logger.scala.html#sbt;Logger" title="sbt.Logger">Logger</a><span class="delimiter">)</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(sources: Seq[java.io.File], classpath: Seq[java.io.File], outputDirectory: java.io.File, options: Seq[String])Unit" id="sbt.compiler;RawCompiler.apply">apply</a><span class="delimiter">(</span><a title="Seq[java.io.File]" id="sbt.compiler;RawCompiler.apply.sources">sources</a>: <span title="Seq[java.io.File]">Seq</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="Seq[java.io.File]" id="sbt.compiler;RawCompiler.apply.classpath">classpath</a>: <span title="Seq[java.io.File]">Seq</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="java.io.File" id="sbt.compiler;RawCompiler.apply.outputDirectory">outputDirectory</a>: <span title="java.io.File">File</span>, <a title="Seq[String]" id="sbt.compiler;RawCompiler.apply.options">options</a>: <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="comment">// reflection is required for binary compatibility</span>
    <span class="comment">// The following import ensures there is a compile error if the identifiers change,</span>
    <span class="comment">//   but should not be otherwise directly referenced</span>
    <span class="keyword">import</span> scala.tools.nsc.<span title="scala.tools.nsc.Main.type">Main</span>.<span class="delimiter">{</span> process =&gt; _ <span class="delimiter">}</span>

    <span class="keyword">val</span> <a title="Seq[String]" id="sbt.compiler;RawCompiler.apply.arguments">arguments</a> = <a href="CompilerArguments.scala.html#sbt.compiler;CompilerArguments.apply" title="(sources: Seq[java.io.File], classpath: Seq[java.io.File], outputDirectory: Option[java.io.File], options: Seq[String])Seq[String]">compilerArguments</a><span class="delimiter">(</span><a href="#sbt.compiler;RawCompiler.apply.sources" title="Seq[java.io.File]">sources</a>, <a href="#sbt.compiler;RawCompiler.apply.classpath" title="Seq[java.io.File]">classpath</a>, <span title="(x: java.io.File)Some[java.io.File]">Some</span><span class="delimiter">(</span><a href="#sbt.compiler;RawCompiler.apply.outputDirectory" title="java.io.File">outputDirectory</a><span class="delimiter">)</span>, <a href="#sbt.compiler;RawCompiler.apply.options" title="Seq[String]">options</a><span class="delimiter">)</span>
    <a href="#sbt.compiler;RawCompiler.log" title="sbt.Logger">log</a>.<a href="../Logger.scala.html#sbt;Logger.debug(83d3728a3c)" title="(message: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="String(&quot;Plain interface to Scala compiler &quot;)" class="string">&quot;Plain interface to Scala compiler &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#sbt.compiler;RawCompiler.scalaInstance" title="=&gt; xsbti.compile.ScalaInstance">scalaInstance</a>.<a href="../../xsbti/compile/ScalaInstance.java.html#xsbti.compile;ScalaInstance.actualVersion" title="()String">actualVersion</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;  with arguments: &quot;)" class="string">&quot;  with arguments: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#sbt.compiler;RawCompiler.apply.arguments" title="Seq[String]">arguments</a>.<span title="(start: String, sep: String, end: String)String">mkString</span><span class="delimiter">(</span><span title="String(&quot;\n\t&quot;)" class="string">&quot;\n\t&quot;</span>, <span title="String(&quot;\n\t&quot;)" class="string">&quot;\n\t&quot;</span>, <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Class[_]" id="sbt.compiler;RawCompiler.apply.mainClass">mainClass</a> = <span title="Class.type">Class</span>.<span title="(x$1: String, x$2: Boolean, x$3: ClassLoader)Class[_]">forName</span><span class="delimiter">(</span><span title="String(&quot;scala.tools.nsc.Main&quot;)" class="string">&quot;scala.tools.nsc.Main&quot;</span>, <span title="Boolean(true)" class="keyword">true</span>, <a href="#sbt.compiler;RawCompiler.scalaInstance" title="=&gt; xsbti.compile.ScalaInstance">scalaInstance</a>.<a href="../../xsbti/compile/ScalaInstance.java.html#xsbti.compile;ScalaInstance.loader" title="()ClassLoader">loader</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="java.lang.reflect.Method" id="sbt.compiler;RawCompiler.apply.process">process</a> = <a href="#sbt.compiler;RawCompiler.apply.mainClass" title="Class[_]">mainClass</a>.<span title="(x$1: String, x$2: &lt;repeated...&gt;[Class[_]])java.lang.reflect.Method">getMethod</span><span class="delimiter">(</span><span title="String(&quot;process&quot;)" class="string">&quot;process&quot;</span>, classOf<span title="Class[Array[String]](classOf[[Ljava.lang.String;])" class="delimiter">[</span>Array<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>
    <a href="#sbt.compiler;RawCompiler.apply.process" title="java.lang.reflect.Method">process</a>.<span title="(x$1: Any, x$2: &lt;repeated...&gt;[Object])Object">invoke</span><span class="delimiter">(</span><span title="Null(null)" class="keyword">null</span>, <a href="#sbt.compiler;RawCompiler.apply.arguments" title="Seq[String]">arguments</a>.<span title="(implicit evidence$1: scala.reflect.ClassTag[String])Array[String]">toArray</span><span class="delimiter">)</span>
    <a href="#sbt.compiler;RawCompiler.checkForFailure" title="(mainClass: Class[_], args: Array[String])Unit">checkForFailure</a><span class="delimiter">(</span><a href="#sbt.compiler;RawCompiler.apply.mainClass" title="Class[_]">mainClass</a>, <a href="#sbt.compiler;RawCompiler.apply.arguments" title="Seq[String]">arguments</a>.<span title="(implicit evidence$1: scala.reflect.ClassTag[String])Array[String]">toArray</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="=&gt; sbt.compiler.CompilerArguments" id="sbt.compiler;RawCompiler.compilerArguments">compilerArguments</a> = <span title="sbt.compiler.CompilerArguments" class="keyword">new</span> <a href="CompilerArguments.scala.html#sbt.compiler;CompilerArguments" title="sbt.compiler.CompilerArguments">CompilerArguments</a><span class="delimiter">(</span><a href="#sbt.compiler;RawCompiler.scalaInstance" title="=&gt; xsbti.compile.ScalaInstance">scalaInstance</a>, <a href="#sbt.compiler;RawCompiler.cp" title="sbt.ClasspathOptions">cp</a><span class="delimiter">)</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(mainClass: Class[_], args: Array[String])Unit" id="sbt.compiler;RawCompiler.checkForFailure">checkForFailure</a><span class="delimiter">(</span><a title="Class[_]" id="sbt.compiler;RawCompiler.checkForFailure.mainClass">mainClass</a>: <span title="Class[_]">Class</span><span class="delimiter">[</span>_<span class="delimiter">]</span>, <a title="Array[String]" id="sbt.compiler;RawCompiler.checkForFailure.args">args</a>: <span title="Array[String]">Array</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Object" id="sbt.compiler;RawCompiler.checkForFailure.reporter">reporter</a> = <a href="#sbt.compiler;RawCompiler.checkForFailure.mainClass" title="Class[_]">mainClass</a>.<span title="(x$1: String, x$2: &lt;repeated...&gt;[Class[_]])java.lang.reflect.Method">getMethod</span><span class="delimiter">(</span><span title="String(&quot;reporter&quot;)" class="string">&quot;reporter&quot;</span><span class="delimiter">)</span>.<span title="(x$1: Any, x$2: &lt;repeated...&gt;[Object])Object">invoke</span><span class="delimiter">(</span><span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Boolean" id="sbt.compiler;RawCompiler.checkForFailure.failed">failed</a> = <a href="#sbt.compiler;RawCompiler.checkForFailure.reporter" title="Object">reporter</a>.<span title="()Class[_]">getClass</span>.<span title="(x$1: String, x$2: &lt;repeated...&gt;[Class[_]])java.lang.reflect.Method">getMethod</span><span class="delimiter">(</span><span title="String(&quot;hasErrors&quot;)" class="string">&quot;hasErrors&quot;</span><span class="delimiter">)</span>.<span title="(x$1: Any, x$2: &lt;repeated...&gt;[Object])Object">invoke</span><span class="delimiter">(</span><a href="#sbt.compiler;RawCompiler.checkForFailure.reporter" title="Object">reporter</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Boolean" class="delimiter">[</span><span title="Boolean">Boolean</span><span class="delimiter">]</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#sbt.compiler;RawCompiler.checkForFailure.failed" title="Boolean">failed</a><span class="delimiter">)</span> <span title="Nothing" class="keyword">throw</span> <span title="sbt.compiler.CompileFailed" class="keyword">new</span> <a href="#sbt.compiler;CompileFailed" title="sbt.compiler.CompileFailed">CompileFailed</a><span class="delimiter">(</span><a href="#sbt.compiler;RawCompiler.checkForFailure.args" title="Array[String]">args</a>, <span title="String(&quot;Plain compile failed&quot;)" class="string">&quot;Plain compile failed&quot;</span>, <span title="(xs: xsbti.Problem*)(implicit evidence$2: scala.reflect.ClassTag[xsbti.Problem])Array[xsbti.Problem]">Array</span><span title="()scala.reflect.ClassTag[xsbti.Problem]" class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>
<span title="AnyRef" class="keyword">class</span> <a title="class CompileFailed extends xsbti.CompileFailed with sbt.FeedbackProvidedException" id="sbt.compiler;CompileFailed">CompileFailed</a><a href="#sbt.compiler;CompileFailed" title="sbt.compiler.CompileFailed" class="delimiter">(</a><span class="keyword">val</span> <a title="Array[String]" id="sbt.compiler;CompileFailed.arguments">arguments</a>: <span title="Array[String]">Array</span><span class="delimiter">[</span>String<span class="delimiter">]</span>, <span class="keyword">override</span> <span class="keyword">val</span> <a title="String" id="sbt.compiler;CompileFailed.toString">toString</a>: <span title="String">String</span>, <span class="keyword">val</span> <a title="Array[xsbti.Problem]" id="sbt.compiler;CompileFailed.problems">problems</a>: <span title="Array[xsbti.Problem]">Array</span><span class="delimiter">[</span>xsbti.Problem<span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> xsbti.<a href="../../xsbti/CompileFailed.java.html#xsbti;CompileFailed" title="xsbti.CompileFailed">CompileFailed</a> <span class="keyword">with</span> <a href="../MessageOnlyException.scala.html#sbt;FeedbackProvidedException" title="sbt.FeedbackProvidedException">FeedbackProvidedException</a>

        </pre>
    </body>
</html>
