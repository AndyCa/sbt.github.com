<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>sbt/IvyCache.scala</title>
        <script type="text/javascript" src="../jquery-all.js"></script>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/* sbt -- Simple Build Tool
 * Copyright 2008, 2009, 2010  Mark Harrah
 */</span>
<span class="keyword">package</span> sbt

<span class="keyword">import</span> java.io.File
<span class="keyword">import</span> java.net.URL

<span class="keyword">import</span> org.apache.ivy.core.cache.<span class="delimiter">{</span> ArtifactOrigin, CacheDownloadOptions, DefaultRepositoryCacheManager <span class="delimiter">}</span>
<span class="keyword">import</span> org.apache.ivy.core.module.descriptor.<span class="delimiter">{</span> Artifact =&gt; IvyArtifact, DefaultArtifact <span class="delimiter">}</span>
<span class="keyword">import</span> org.apache.ivy.plugins.repository.file.<span class="delimiter">{</span> FileRepository =&gt; IvyFileRepository, FileResource <span class="delimiter">}</span>
<span class="keyword">import</span> org.apache.ivy.plugins.repository.<span class="delimiter">{</span> ArtifactResourceResolver, Resource, ResourceDownloader <span class="delimiter">}</span>
<span class="keyword">import</span> org.apache.ivy.plugins.resolver.util.ResolvedResource
<span class="keyword">import</span> org.apache.ivy.util.FileUtil

<span class="keyword">class</span> <a title="class NotInCache extends RuntimeException" id="sbt;NotInCache">NotInCache</a><a href="#sbt;NotInCache" title="sbt.NotInCache" class="delimiter">(</a><span class="keyword">val</span> <a title="sbt.ModuleID" id="sbt;NotInCache.id">id</a>: <a href="ModuleID.scala.html#sbt;ModuleID" title="sbt.ModuleID">ModuleID</a>, <a title="Throwable" id="sbt;NotInCache.cause">cause</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>
    <span class="keyword">extends</span> <span title="RuntimeException">RuntimeException</span><span class="delimiter">(</span><a href="#sbt.NotInCache.apply" title="(id: sbt.ModuleID, cause: Throwable)String">NotInCache</a><span class="delimiter">(</span><a href="#sbt;NotInCache.id" title="sbt.ModuleID">id</a>, <a href="#sbt;NotInCache.cause" title="Throwable">cause</a><span class="delimiter">)</span>, <a href="#sbt;NotInCache.cause" title="Throwable">cause</a><span class="delimiter">)</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(id: sbt.ModuleID)sbt.NotInCache" id="sbt;NotInCache.<init>(4ef0975fd3)" class="keyword">this</a><span class="delimiter">(</span><a title="sbt.ModuleID" id="sbt;NotInCache.<init>(4ef0975fd3).id">id</a>: <a href="ModuleID.scala.html#sbt;ModuleID" title="sbt.ModuleID">ModuleID</a><span class="delimiter">)</span> = <a href="#sbt;NotInCache" title="NotInCache.this.type" class="keyword">this</a><span class="delimiter">(</span><a href="#sbt;NotInCache.<init>(4ef0975fd3).id" title="sbt.ModuleID">id</a>, <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
<span class="delimiter">}</span>
<span class="keyword">private</span> <span class="keyword">object</span> <a title="sbt.NotInCache.type" id="sbt.NotInCache.readResolve">NotInCache</a> <a href="#sbt.NotInCache.readResolve" title="sbt.NotInCache.type" class="delimiter">{</a>
  <span class="keyword">def</span> <a title="(id: sbt.ModuleID, cause: Throwable)String" id="sbt.NotInCache.apply">apply</a><span class="delimiter">(</span><a title="sbt.ModuleID" id="sbt.NotInCache.apply.id">id</a>: <a href="ModuleID.scala.html#sbt;ModuleID" title="sbt.ModuleID">ModuleID</a>, <a title="Throwable" id="sbt.NotInCache.apply.cause">cause</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span> =
    <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="String" id="sbt.NotInCache.apply.postfix">postfix</a> = <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#sbt.NotInCache.apply.cause" title="Throwable">cause</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span> <span class="keyword">else</span> <span class="delimiter">(</span><span title="String(&quot;: &quot;)" class="string">&quot;: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#sbt.NotInCache.apply.cause" title="Throwable">cause</a>.<span title="()String">toString</span><span class="delimiter">)</span>
      <span title="String(&quot;File for &quot;)" class="string">&quot;File for &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#sbt.NotInCache.apply.id" title="sbt.ModuleID">id</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; not in cache&quot;)" class="string">&quot; not in cache&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#sbt.NotInCache.apply.postfix" title="String">postfix</a>
    <span class="delimiter">}</span>
<span class="delimiter">}</span>
<span class="comment">/** Provides methods for working at the level of a single jar file with the default Ivy cache.*/</span>
<span title="AnyRef" class="keyword">class</span> <a title="class IvyCache extends AnyRef" id="sbt;IvyCache">IvyCache</a><a href="#sbt;IvyCache" title="sbt.IvyCache" class="delimiter">(</a><span class="keyword">val</span> <a title="Option[java.io.File]" id="sbt;IvyCache.ivyHome">ivyHome</a>: <span title="Option[java.io.File]">Option</span><span class="delimiter">[</span>File<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="=&gt; java.io.File" id="sbt;IvyCache.lockFile">lockFile</a> = <span title="(x$1: java.io.File, x$2: String)java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><a href="#sbt;IvyCache.ivyHome" title="=&gt; Option[java.io.File]">ivyHome</a> <span title="(default: =&gt; java.io.File)java.io.File">getOrElse</span> <a href="Path.scala.html#sbt.Path" title="sbt.Path.type">Path</a>.<a href="Path.scala.html#sbt.Path.userHome" title="=&gt; java.io.File">userHome</a>, <span title="String(&quot;.sbt.cache.lock&quot;)" class="string">&quot;.sbt.cache.lock&quot;</span><span class="delimiter">)</span>
  <span class="comment">/** Caches the given 'file' with the given ID.  It may be retrieved or cleared using this ID.*/</span>
  <span class="keyword">def</span> <a title="(moduleID: sbt.ModuleID, file: java.io.File, lock: Option[xsbti.GlobalLock], log: sbt.Logger)Unit" id="sbt;IvyCache.cacheJar">cacheJar</a><span class="delimiter">(</span><a title="sbt.ModuleID" id="sbt;IvyCache.cacheJar.moduleID">moduleID</a>: <a href="ModuleID.scala.html#sbt;ModuleID" title="sbt.ModuleID">ModuleID</a>, <a title="java.io.File" id="sbt;IvyCache.cacheJar.file">file</a>: <span title="java.io.File">File</span>, <a title="Option[xsbti.GlobalLock]" id="sbt;IvyCache.cacheJar.lock">lock</a>: <span title="Option[xsbti.GlobalLock]">Option</span><span class="delimiter">[</span>xsbti.GlobalLock<span class="delimiter">]</span>, <a title="sbt.Logger" id="sbt;IvyCache.cacheJar.log">log</a>: <a href="Logger.scala.html#sbt;Logger" title="sbt.Logger">Logger</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="org.apache.ivy.core.module.descriptor.Artifact" id="sbt;IvyCache.cacheJar.artifact">artifact</a> = <a href="#sbt;IvyCache.defaultArtifact" title="(moduleID: sbt.ModuleID)org.apache.ivy.core.module.descriptor.Artifact">defaultArtifact</a><span class="delimiter">(</span><a href="#sbt;IvyCache.cacheJar.moduleID" title="sbt.ModuleID">moduleID</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="org.apache.ivy.plugins.resolver.util.ResolvedResource" id="sbt;IvyCache.cacheJar.resolved">resolved</a> = <span title="org.apache.ivy.plugins.resolver.util.ResolvedResource" class="keyword">new</span> <span title="org.apache.ivy.plugins.resolver.util.ResolvedResource">ResolvedResource</span><span class="delimiter">(</span><span title="org.apache.ivy.plugins.repository.file.FileResource" class="keyword">new</span> <span title="org.apache.ivy.plugins.repository.file.FileResource">FileResource</span><span class="delimiter">(</span><span title="org.apache.ivy.plugins.repository.file.FileRepository" class="keyword">new</span> <span title="org.apache.ivy.plugins.repository.file.FileRepository">IvyFileRepository</span>, <a href="#sbt;IvyCache.cacheJar.file" title="java.io.File">file</a><span class="delimiter">)</span>, <a href="#sbt;IvyCache.cacheJar.moduleID" title="sbt.ModuleID">moduleID</a>.<a href="ModuleID.scala.html#sbt;ModuleID.revision" title="=&gt; String">revision</a><span class="delimiter">)</span>
    <a href="#sbt;IvyCache.withDefaultCache" title="(lock: Option[xsbti.GlobalLock], log: sbt.Logger)(f: org.apache.ivy.core.cache.DefaultRepositoryCacheManager =&gt; org.apache.ivy.core.report.ArtifactDownloadReport)org.apache.ivy.core.report.ArtifactDownloadReport">withDefaultCache</a><span class="delimiter">(</span><a href="#sbt;IvyCache.cacheJar.lock" title="Option[xsbti.GlobalLock]">lock</a>, <a href="#sbt;IvyCache.cacheJar.log" title="sbt.Logger">log</a><span class="delimiter">)</span> <span title="Unit" class="delimiter">{</span> <a title="org.apache.ivy.core.cache.DefaultRepositoryCacheManager" id="sbt;IvyCache.cacheJar.$anonfun.cache">cache</a> =&gt;
      <span class="keyword">val</span> <a title="resolver extends Object with org.apache.ivy.plugins.repository.ArtifactResourceResolver" id="sbt;IvyCache.cacheJar.$anonfun.resolver">resolver</a> = <a href="#sbt;IvyCache.cacheJar.$anonfun.resolver;$anon" title="org.apache.ivy.plugins.repository.ArtifactResourceResolver" class="keyword">new</a> <a title="anonymous class $anon extends Object with org.apache.ivy.plugins.repository.ArtifactResourceResolver" id="sbt;IvyCache.cacheJar.$anonfun.resolver;$anon">ArtifactResourceResolver</a> <span class="delimiter">{</span> <span class="keyword">def</span> <a title="(artifact: org.apache.ivy.core.module.descriptor.Artifact)org.apache.ivy.plugins.resolver.util.ResolvedResource" id="sbt;IvyCache.cacheJar.$anonfun.resolver;$anon.resolve">resolve</a><span class="delimiter">(</span><a title="org.apache.ivy.core.module.descriptor.Artifact" id="sbt;IvyCache.cacheJar.$anonfun.resolver;$anon.resolve.artifact">artifact</a>: <span title="org.apache.ivy.core.module.descriptor.Artifact">IvyArtifact</span><span class="delimiter">)</span> = <a href="#sbt;IvyCache.cacheJar.resolved" title="org.apache.ivy.plugins.resolver.util.ResolvedResource">resolved</a> <span class="delimiter">}</span>
      <a href="#sbt;IvyCache.cacheJar.$anonfun.cache" title="org.apache.ivy.core.cache.DefaultRepositoryCacheManager">cache</a>.<span title="(x$1: org.apache.ivy.core.module.descriptor.Artifact, x$2: org.apache.ivy.plugins.repository.ArtifactResourceResolver, x$3: org.apache.ivy.plugins.repository.ResourceDownloader, x$4: org.apache.ivy.core.cache.CacheDownloadOptions)org.apache.ivy.core.report.ArtifactDownloadReport">download</span><span class="delimiter">(</span><a href="#sbt;IvyCache.cacheJar.artifact" title="org.apache.ivy.core.module.descriptor.Artifact">artifact</a>, <a href="#sbt;IvyCache.cacheJar.$anonfun.resolver" title="resolver extends Object with org.apache.ivy.plugins.repository.ArtifactResourceResolver">resolver</a>, <span title="sbt.FileDownloader" class="keyword">new</span> <a href="#sbt;FileDownloader" title="sbt.FileDownloader">FileDownloader</a>, <span title="org.apache.ivy.core.cache.CacheDownloadOptions" class="keyword">new</span> <span title="org.apache.ivy.core.cache.CacheDownloadOptions">CacheDownloadOptions</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  <span class="comment">/** Clears the cache of the jar for the given ID.*/</span>
  <span class="keyword">def</span> <a title="(id: sbt.ModuleID, lock: Option[xsbti.GlobalLock], log: sbt.Logger)Unit" id="sbt;IvyCache.clearCachedJar">clearCachedJar</a><span class="delimiter">(</span><a title="sbt.ModuleID" id="sbt;IvyCache.clearCachedJar.id">id</a>: <a href="ModuleID.scala.html#sbt;ModuleID" title="sbt.ModuleID">ModuleID</a>, <a title="Option[xsbti.GlobalLock]" id="sbt;IvyCache.clearCachedJar.lock">lock</a>: <span title="Option[xsbti.GlobalLock]">Option</span><span class="delimiter">[</span>xsbti.GlobalLock<span class="delimiter">]</span>, <a title="sbt.Logger" id="sbt;IvyCache.clearCachedJar.log">log</a>: <a href="Logger.scala.html#sbt;Logger" title="sbt.Logger">Logger</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <span class="keyword">try</span> <span class="delimiter">{</span> <a href="#sbt;IvyCache.withCachedJar" title="(id: sbt.ModuleID, lock: Option[xsbti.GlobalLock], log: sbt.Logger)(f: java.io.File =&gt; Boolean)Boolean">withCachedJar</a><span class="delimiter">(</span><a href="#sbt;IvyCache.clearCachedJar.id" title="sbt.ModuleID">id</a>, <a href="#sbt;IvyCache.clearCachedJar.lock" title="Option[xsbti.GlobalLock]">lock</a>, <a href="#sbt;IvyCache.clearCachedJar.log" title="sbt.Logger">log</a><span class="delimiter">)</span><span title="Unit" class="delimiter">(</span><a href="#sbt;IvyCache.clearCachedJar.$anonfun.x$1" title="java.io.File">_</a>.<span title="()Boolean">delete</span><span class="delimiter">)</span> <span class="delimiter">}</span>
    <span class="keyword">catch</span> <span class="delimiter">{</span> <span class="keyword">case</span> <a title="Exception" id="sbt;IvyCache.clearCachedJar.e">e</a>: <span title="Exception">Exception</span> =&gt; <a href="#sbt;IvyCache.clearCachedJar.log" title="sbt.Logger">log</a>.<a href="Logger.scala.html#sbt;Logger.debug(83d3728a3c)" title="(message: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="String(&quot;Error cleaning cached jar: &quot;)" class="string">&quot;Error cleaning cached jar: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#sbt;IvyCache.clearCachedJar.e" title="Exception">e</a>.<span title="()String">toString</span><span class="delimiter">)</span> <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  <span class="comment">/** Copies the cached jar for the given ID to the directory 'toDirectory'.  If the jar is not in the cache, NotInCache is thrown.*/</span>
  <span class="keyword">def</span> <a title="(id: sbt.ModuleID, toDirectory: java.io.File, lock: Option[xsbti.GlobalLock], log: sbt.Logger)java.io.File" id="sbt;IvyCache.retrieveCachedJar">retrieveCachedJar</a><span class="delimiter">(</span><a title="sbt.ModuleID" id="sbt;IvyCache.retrieveCachedJar.id">id</a>: <a href="ModuleID.scala.html#sbt;ModuleID" title="sbt.ModuleID">ModuleID</a>, <a title="java.io.File" id="sbt;IvyCache.retrieveCachedJar.toDirectory">toDirectory</a>: <span title="java.io.File">File</span>, <a title="Option[xsbti.GlobalLock]" id="sbt;IvyCache.retrieveCachedJar.lock">lock</a>: <span title="Option[xsbti.GlobalLock]">Option</span><span class="delimiter">[</span>xsbti.GlobalLock<span class="delimiter">]</span>, <a title="sbt.Logger" id="sbt;IvyCache.retrieveCachedJar.log">log</a>: <a href="Logger.scala.html#sbt;Logger" title="sbt.Logger">Logger</a><span class="delimiter">)</span> =
    <a href="#sbt;IvyCache.withCachedJar" title="(id: sbt.ModuleID, lock: Option[xsbti.GlobalLock], log: sbt.Logger)(f: java.io.File =&gt; java.io.File)java.io.File">withCachedJar</a><span class="delimiter">(</span><a href="#sbt;IvyCache.retrieveCachedJar.id" title="sbt.ModuleID">id</a>, <a href="#sbt;IvyCache.retrieveCachedJar.lock" title="Option[xsbti.GlobalLock]">lock</a>, <a href="#sbt;IvyCache.retrieveCachedJar.log" title="sbt.Logger">log</a><span class="delimiter">)</span> <span class="delimiter">{</span> <a title="java.io.File" id="sbt;IvyCache.retrieveCachedJar.$anonfun.cachedFile">cachedFile</a> =&gt;
      <span class="keyword">val</span> <a title="java.io.File" id="sbt;IvyCache.retrieveCachedJar.$anonfun.copyTo">copyTo</a> = <span title="(x$1: java.io.File, x$2: String)java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><a href="#sbt;IvyCache.retrieveCachedJar.toDirectory" title="java.io.File">toDirectory</a>, <a href="#sbt;IvyCache.retrieveCachedJar.$anonfun.cachedFile" title="java.io.File">cachedFile</a>.<span title="()String">getName</span><span class="delimiter">)</span>
      <span title="org.apache.ivy.util.FileUtil.type">FileUtil</span>.<span title="(x$1: java.io.File, x$2: java.io.File, x$3: org.apache.ivy.util.CopyProgressListener)Boolean">copy</span><span class="delimiter">(</span><a href="#sbt;IvyCache.retrieveCachedJar.$anonfun.cachedFile" title="java.io.File">cachedFile</a>, <a href="#sbt;IvyCache.retrieveCachedJar.$anonfun.copyTo" title="java.io.File">copyTo</a>, <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
      <a href="#sbt;IvyCache.retrieveCachedJar.$anonfun.copyTo" title="java.io.File">copyTo</a>
    <span class="delimiter">}</span>

  <span class="comment">/** Get the location of the cached jar for the given ID in the Ivy cache.  If the jar is not in the cache, NotInCache is thrown .*/</span>
  <span class="keyword">def</span> <a title="[T](id: sbt.ModuleID, lock: Option[xsbti.GlobalLock], log: sbt.Logger)(f: java.io.File =&gt; T)T" id="sbt;IvyCache.withCachedJar">withCachedJar</a><span class="delimiter">[</span><a title="" id="sbt;IvyCache.withCachedJar;T">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="sbt.ModuleID" id="sbt;IvyCache.withCachedJar.id">id</a>: <a href="ModuleID.scala.html#sbt;ModuleID" title="sbt.ModuleID">ModuleID</a>, <a title="Option[xsbti.GlobalLock]" id="sbt;IvyCache.withCachedJar.lock">lock</a>: <span title="Option[xsbti.GlobalLock]">Option</span><span class="delimiter">[</span>xsbti.GlobalLock<span class="delimiter">]</span>, <a title="sbt.Logger" id="sbt;IvyCache.withCachedJar.log">log</a>: <a href="Logger.scala.html#sbt;Logger" title="sbt.Logger">Logger</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="java.io.File =&gt; T" id="sbt;IvyCache.withCachedJar.f">f</a>: File =&gt; T<span class="delimiter">)</span>: <a href="#sbt;IvyCache.withCachedJar;T" title="T">T</a> =
    <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="java.io.File" id="sbt;IvyCache.withCachedJar.cachedFile">cachedFile</a> =
        <span class="keyword">try</span> <span class="delimiter">{</span>
          <a href="#sbt;IvyCache.withDefaultCache" title="(lock: Option[xsbti.GlobalLock], log: sbt.Logger)(f: org.apache.ivy.core.cache.DefaultRepositoryCacheManager =&gt; java.io.File)java.io.File">withDefaultCache</a><span class="delimiter">(</span><a href="#sbt;IvyCache.withCachedJar.lock" title="Option[xsbti.GlobalLock]">lock</a>, <a href="#sbt;IvyCache.withCachedJar.log" title="sbt.Logger">log</a><span class="delimiter">)</span> <span class="delimiter">{</span> <a title="org.apache.ivy.core.cache.DefaultRepositoryCacheManager" id="sbt;IvyCache.withCachedJar.cachedFile.$anonfun.cache">cache</a> =&gt;
            <span class="keyword">val</span> <a title="org.apache.ivy.core.module.descriptor.Artifact" id="sbt;IvyCache.withCachedJar.cachedFile.$anonfun.artifact">artifact</a> = <a href="#sbt;IvyCache.defaultArtifact" title="(moduleID: sbt.ModuleID)org.apache.ivy.core.module.descriptor.Artifact">defaultArtifact</a><span class="delimiter">(</span><a href="#sbt;IvyCache.withCachedJar.id" title="sbt.ModuleID">id</a><span class="delimiter">)</span>
            <a href="#sbt;IvyCache.withCachedJar.cachedFile.$anonfun.cache" title="org.apache.ivy.core.cache.DefaultRepositoryCacheManager">cache</a>.<span title="(x$1: org.apache.ivy.core.module.descriptor.Artifact, x$2: org.apache.ivy.core.cache.ArtifactOrigin)java.io.File">getArchiveFileInCache</span><span class="delimiter">(</span><a href="#sbt;IvyCache.withCachedJar.cachedFile.$anonfun.artifact" title="org.apache.ivy.core.module.descriptor.Artifact">artifact</a>, <a href="#sbt;IvyCache.unknownOrigin" title="(artifact: org.apache.ivy.core.module.descriptor.Artifact)org.apache.ivy.core.cache.ArtifactOrigin">unknownOrigin</a><span class="delimiter">(</span><a href="#sbt;IvyCache.withCachedJar.cachedFile.$anonfun.artifact" title="org.apache.ivy.core.module.descriptor.Artifact">artifact</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span> <span class="keyword">case</span> <a title="Exception" id="sbt;IvyCache.withCachedJar.cachedFile.e">e</a>: <span title="Exception">Exception</span> =&gt; <span title="Nothing" class="keyword">throw</span> <span title="sbt.NotInCache" class="keyword">new</span> <a href="#sbt;NotInCache" title="sbt.NotInCache">NotInCache</a><span class="delimiter">(</span><a href="#sbt;IvyCache.withCachedJar.id" title="sbt.ModuleID">id</a>, <a href="#sbt;IvyCache.withCachedJar.cachedFile.e" title="Exception">e</a><span class="delimiter">)</span> <span class="delimiter">}</span>

      <span title="T" class="keyword">if</span> <span class="delimiter">(</span><a href="#sbt;IvyCache.withCachedJar.cachedFile" title="java.io.File">cachedFile</a>.<span title="()Boolean">exists</span><span class="delimiter">)</span> <a href="#sbt;IvyCache.withCachedJar.f" title="(v1: java.io.File)T">f</a><span class="delimiter">(</span><a href="#sbt;IvyCache.withCachedJar.cachedFile" title="java.io.File">cachedFile</a><span class="delimiter">)</span> <span class="keyword">else</span> <span title="Nothing" class="keyword">throw</span> <a href="#sbt;NotInCache.<init>(4ef0975fd3)" title="(id: sbt.ModuleID)sbt.NotInCache" class="keyword">new</a> <a href="#sbt;NotInCache" title="sbt.NotInCache">NotInCache</a><span class="delimiter">(</span><a href="#sbt;IvyCache.withCachedJar.id" title="sbt.ModuleID">id</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="comment">/** Calls the given function with the default Ivy cache.*/</span>
  <span class="keyword">def</span> <a title="[T](lock: Option[xsbti.GlobalLock], log: sbt.Logger)(f: org.apache.ivy.core.cache.DefaultRepositoryCacheManager =&gt; T)T" id="sbt;IvyCache.withDefaultCache">withDefaultCache</a><span class="delimiter">[</span><a title="" id="sbt;IvyCache.withDefaultCache;T">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Option[xsbti.GlobalLock]" id="sbt;IvyCache.withDefaultCache.lock">lock</a>: <span title="Option[xsbti.GlobalLock]">Option</span><span class="delimiter">[</span>xsbti.GlobalLock<span class="delimiter">]</span>, <a title="sbt.Logger" id="sbt;IvyCache.withDefaultCache.log">log</a>: <a href="Logger.scala.html#sbt;Logger" title="sbt.Logger">Logger</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="org.apache.ivy.core.cache.DefaultRepositoryCacheManager =&gt; T" id="sbt;IvyCache.withDefaultCache.f">f</a>: DefaultRepositoryCacheManager =&gt; T<span class="delimiter">)</span>: <a href="#sbt;IvyCache.withDefaultCache;T" title="T">T</a> =
    <span class="delimiter">{</span>
      <span class="keyword">val</span> <a href="#sbt;IvyCache.withDefaultCache.ivy" title="(sbt.IvySbt, sbt.FileRepository)" class="delimiter">(</a><a href="#sbt;IvyCache.withDefaultCache.x$2" title="sbt.IvySbt" id="sbt;IvyCache.withDefaultCache.ivy">ivy</a>, <a href="#sbt;IvyCache.withDefaultCache.x$2" title="sbt.FileRepository" id="sbt;IvyCache.withDefaultCache.local">local</a><span class="delimiter">)</span> = <a href="#sbt;IvyCache.basicLocalIvy" title="(lock: Option[xsbti.GlobalLock], log: sbt.Logger)(sbt.IvySbt, sbt.FileRepository)">basicLocalIvy</a><span title="(sbt.IvySbt, sbt.FileRepository) @unchecked" class="delimiter">(</span><a href="#sbt;IvyCache.withDefaultCache.lock" title="Option[xsbti.GlobalLock]">lock</a>, <a href="#sbt;IvyCache.withDefaultCache.log" title="sbt.Logger">log</a><span class="delimiter">)</span>
      <a href="#sbt;IvyCache.withDefaultCache.ivy" title="sbt.IvySbt">ivy</a>.<a href="Ivy.scala.html#sbt;IvySbt.withIvy(61041e0039)" title="(log: sbt.Logger)(f: org.apache.ivy.Ivy =&gt; T)T">withIvy</a><span class="delimiter">(</span><a href="#sbt;IvyCache.withDefaultCache.log" title="sbt.Logger">log</a><span class="delimiter">)</span> <span class="delimiter">{</span> <a title="org.apache.ivy.Ivy" id="sbt;IvyCache.withDefaultCache.$anonfun.ivy">ivy</a> =&gt;
        <span class="keyword">val</span> <a title="org.apache.ivy.core.cache.DefaultRepositoryCacheManager" id="sbt;IvyCache.withDefaultCache.$anonfun.cache">cache</a> = <a href="#sbt;IvyCache.withDefaultCache.$anonfun.ivy" title="org.apache.ivy.Ivy">ivy</a>.<span title="()org.apache.ivy.core.settings.IvySettings">getSettings</span>.<span title="()org.apache.ivy.core.cache.RepositoryCacheManager">getDefaultRepositoryCacheManager</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="org.apache.ivy.core.cache.DefaultRepositoryCacheManager" class="delimiter">[</span><span title="org.apache.ivy.core.cache.DefaultRepositoryCacheManager">DefaultRepositoryCacheManager</span><span class="delimiter">]</span>
        <a href="#sbt;IvyCache.withDefaultCache.$anonfun.cache" title="org.apache.ivy.core.cache.DefaultRepositoryCacheManager">cache</a>.<span title="(x$1: Boolean)Unit">setUseOrigin</span><span class="delimiter">(</span><span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>
        <a href="#sbt;IvyCache.withDefaultCache.f" title="(v1: org.apache.ivy.core.cache.DefaultRepositoryCacheManager)T">f</a><span class="delimiter">(</span><a href="#sbt;IvyCache.withDefaultCache.$anonfun.cache" title="org.apache.ivy.core.cache.DefaultRepositoryCacheManager">cache</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(artifact: org.apache.ivy.core.module.descriptor.Artifact)org.apache.ivy.core.cache.ArtifactOrigin" id="sbt;IvyCache.unknownOrigin">unknownOrigin</a><span class="delimiter">(</span><a title="org.apache.ivy.core.module.descriptor.Artifact" id="sbt;IvyCache.unknownOrigin.artifact">artifact</a>: <span title="org.apache.ivy.core.module.descriptor.Artifact">IvyArtifact</span><span class="delimiter">)</span> = <span title="org.apache.ivy.core.cache.ArtifactOrigin.type">ArtifactOrigin</span>.<span title="(x$1: org.apache.ivy.core.module.descriptor.Artifact)org.apache.ivy.core.cache.ArtifactOrigin">unkwnown</span><span class="delimiter">(</span><a href="#sbt;IvyCache.unknownOrigin.artifact" title="org.apache.ivy.core.module.descriptor.Artifact">artifact</a><span class="delimiter">)</span>
  <span class="comment">/** A minimal Ivy setup with only a local resolver and the current directory as the base directory.*/</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(lock: Option[xsbti.GlobalLock], log: sbt.Logger)(sbt.IvySbt, sbt.FileRepository)" id="sbt;IvyCache.basicLocalIvy">basicLocalIvy</a><span class="delimiter">(</span><a title="Option[xsbti.GlobalLock]" id="sbt;IvyCache.basicLocalIvy.lock">lock</a>: <span title="Option[xsbti.GlobalLock]">Option</span><span class="delimiter">[</span>xsbti.GlobalLock<span class="delimiter">]</span>, <a title="sbt.Logger" id="sbt;IvyCache.basicLocalIvy.log">log</a>: <a href="Logger.scala.html#sbt;Logger" title="sbt.Logger">Logger</a><span class="delimiter">)</span> =
    <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="sbt.FileRepository" id="sbt;IvyCache.basicLocalIvy.local">local</a> = <a href="Resolver.scala.html#sbt.Resolver" title="sbt.Resolver.type">Resolver</a>.<a href="Resolver.scala.html#sbt.Resolver.defaultLocal" title="=&gt; sbt.FileRepository">defaultLocal</a>
      <span class="keyword">val</span> <a title="sbt.IvyPaths" id="sbt;IvyCache.basicLocalIvy.paths">paths</a> = <span title="sbt.IvyPaths" class="keyword">new</span> <a href="IvyConfigurations.scala.html#sbt;IvyPaths" title="sbt.IvyPaths">IvyPaths</a><span class="delimiter">(</span><span title="java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><span title="String(&quot;.&quot;)" class="string">&quot;.&quot;</span><span class="delimiter">)</span>, <a href="#sbt;IvyCache.ivyHome" title="=&gt; Option[java.io.File]">ivyHome</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="sbt.InlineIvyConfiguration" id="sbt;IvyCache.basicLocalIvy.conf">conf</a> = <a href="IvyConfigurations.scala.html#sbt;InlineIvyConfiguration.<init>(2436db99d1)" title="(paths: sbt.IvyPaths, resolvers: Seq[sbt.Resolver], otherResolvers: Seq[sbt.Resolver], moduleConfigurations: Seq[sbt.ModuleConfiguration], localOnly: Boolean, lock: Option[xsbti.GlobalLock], checksums: Seq[String], resolutionCacheDir: Option[java.io.File], log: sbt.Logger)sbt.InlineIvyConfiguration" class="keyword">new</a> <a href="IvyConfigurations.scala.html#sbt;InlineIvyConfiguration" title="sbt.InlineIvyConfiguration">InlineIvyConfiguration</a><span class="delimiter">(</span><a href="#sbt;IvyCache.basicLocalIvy.paths" title="sbt.IvyPaths">paths</a>, <span title="(elems: sbt.FileRepository*)Seq[sbt.FileRepository]">Seq</span><span class="delimiter">(</span><a href="#sbt;IvyCache.basicLocalIvy.local" title="sbt.FileRepository">local</a><span class="delimiter">)</span>, <span title="scala.collection.immutable.Nil.type">Nil</span>, <span title="scala.collection.immutable.Nil.type">Nil</span>, <span title="Boolean(false)" class="keyword">false</span>, <a href="#sbt;IvyCache.basicLocalIvy.lock" title="Option[xsbti.GlobalLock]">lock</a>, <a href="Ivy.scala.html#sbt.IvySbt" title="sbt.IvySbt.type">IvySbt</a>.<a href="Ivy.scala.html#sbt.IvySbt.DefaultChecksums" title="=&gt; Seq[String]">DefaultChecksums</a>, <span title="None.type">None</span>, <a href="#sbt;IvyCache.basicLocalIvy.log" title="sbt.Logger">log</a><span class="delimiter">)</span>
      <span title="(_1: sbt.IvySbt, _2: sbt.FileRepository)(sbt.IvySbt, sbt.FileRepository)" class="delimiter">(</span><span title="sbt.IvySbt" class="keyword">new</span> <a href="Ivy.scala.html#sbt;IvySbt" title="sbt.IvySbt">IvySbt</a><span class="delimiter">(</span><a href="#sbt;IvyCache.basicLocalIvy.conf" title="sbt.InlineIvyConfiguration">conf</a><span class="delimiter">)</span>, <a href="#sbt;IvyCache.basicLocalIvy.local" title="sbt.FileRepository">local</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="comment">/** Creates a default jar artifact based on the given ID.*/</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(moduleID: sbt.ModuleID)org.apache.ivy.core.module.descriptor.Artifact" id="sbt;IvyCache.defaultArtifact">defaultArtifact</a><span class="delimiter">(</span><a title="sbt.ModuleID" id="sbt;IvyCache.defaultArtifact.moduleID">moduleID</a>: <a href="ModuleID.scala.html#sbt;ModuleID" title="sbt.ModuleID">ModuleID</a><span class="delimiter">)</span>: <span title="org.apache.ivy.core.module.descriptor.Artifact">IvyArtifact</span> =
    <span title="org.apache.ivy.core.module.descriptor.DefaultArtifact" class="keyword">new</span> <span title="org.apache.ivy.core.module.descriptor.DefaultArtifact">DefaultArtifact</span><span class="delimiter">(</span><a href="Ivy.scala.html#sbt.IvySbt" title="sbt.IvySbt.type">IvySbt</a>.<a href="Ivy.scala.html#sbt.IvySbt.toID" title="(m: sbt.ModuleID)org.apache.ivy.core.module.id.ModuleRevisionId">toID</a><span class="delimiter">(</span><a href="#sbt;IvyCache.defaultArtifact.moduleID" title="sbt.ModuleID">moduleID</a><span class="delimiter">)</span>, <span title="Null(null)" class="keyword">null</span>, <a href="#sbt;IvyCache.defaultArtifact.moduleID" title="sbt.ModuleID">moduleID</a>.<a href="ModuleID.scala.html#sbt;ModuleID.name" title="=&gt; String">name</a>, <span title="String(&quot;jar&quot;)" class="string">&quot;jar&quot;</span>, <span title="String(&quot;jar&quot;)" class="string">&quot;jar&quot;</span><span class="delimiter">)</span>
<span class="delimiter">}</span>
<span class="comment">/** Required by Ivy for copying to the cache.*/</span>
<span title="AnyRef" class="keyword">private</span> <span class="keyword">class</span> <a title="class FileDownloader extends Object with org.apache.ivy.plugins.repository.ResourceDownloader with NotNull" id="sbt;FileDownloader">FileDownloader</a> <a href="#sbt;FileDownloader" title="sbt.FileDownloader" class="keyword">extends</a> <span title="org.apache.ivy.plugins.repository.ResourceDownloader">ResourceDownloader</span> <span class="keyword">with</span> <span title="NotNull">NotNull</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(artifact: org.apache.ivy.core.module.descriptor.Artifact, resource: org.apache.ivy.plugins.repository.Resource, dest: java.io.File)Unit" id="sbt;FileDownloader.download">download</a><span class="delimiter">(</span><a title="org.apache.ivy.core.module.descriptor.Artifact" id="sbt;FileDownloader.download.artifact">artifact</a>: <span title="org.apache.ivy.core.module.descriptor.Artifact">IvyArtifact</span>, <a title="org.apache.ivy.plugins.repository.Resource" id="sbt;FileDownloader.download.resource">resource</a>: <span title="org.apache.ivy.plugins.repository.Resource">Resource</span>, <a title="java.io.File" id="sbt;FileDownloader.download.dest">dest</a>: <span title="java.io.File">File</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <span title="AnyVal" class="keyword">if</span> <span class="delimiter">(</span><a href="#sbt;FileDownloader.download.dest" title="java.io.File">dest</a>.<span title="()Boolean">exists</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#sbt;FileDownloader.download.dest" title="java.io.File">dest</a>.<span title="()Boolean">delete</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="java.io.File" id="sbt;FileDownloader.download.part">part</a> = <span title="java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><a href="#sbt;FileDownloader.download.dest" title="java.io.File">dest</a>.<span title="()String">getAbsolutePath</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot;.part&quot;)" class="string">&quot;.part&quot;</span><span class="delimiter">)</span>
    <span title="org.apache.ivy.util.FileUtil.type">FileUtil</span>.<span title="(x$1: java.io.InputStream, x$2: java.io.File, x$3: org.apache.ivy.util.CopyProgressListener)Unit">copy</span><span class="delimiter">(</span><a href="#sbt;FileDownloader.download.resource" title="org.apache.ivy.plugins.repository.Resource">resource</a>.<span title="()java.io.InputStream">openStream</span>, <a href="#sbt;FileDownloader.download.part" title="java.io.File">part</a>, <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#sbt;FileDownloader.download.part" title="java.io.File">part</a>.<span title="(x$1: java.io.File)Boolean">renameTo</span><span class="delimiter">(</span><a href="#sbt;FileDownloader.download.dest" title="java.io.File">dest</a><span class="delimiter">)</span><span class="delimiter">)</span>
      sys.<span title="(message: String)Nothing">error</span><span class="delimiter">(</span><span title="String(&quot;Could not move temporary file &quot;)" class="string">&quot;Could not move temporary file &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#sbt;FileDownloader.download.part" title="java.io.File">part</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; to final location &quot;)" class="string">&quot; to final location &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#sbt;FileDownloader.download.dest" title="java.io.File">dest</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>
