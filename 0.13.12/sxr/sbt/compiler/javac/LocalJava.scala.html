<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>sbt/compiler/javac/LocalJava.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> sbt.compiler.javac

<span class="keyword">import</span> java.io.<span class="delimiter">{</span> File, PrintWriter <span class="delimiter">}</span>

<span class="keyword">import</span> sbt.<span class="delimiter">{</span> LoggerWriter, Level, Logger <span class="delimiter">}</span>
<span class="keyword">import</span> xsbti.Reporter
<span class="keyword">import</span> xsbti.compile.<span class="delimiter">{</span> ScalaInstance, ClasspathOptions <span class="delimiter">}</span>

<span class="comment">/**
 * Helper methods for trying to run the java toolchain out of our own classloaders.
 */</span>
<span class="keyword">object</span> <a title="sbt.compiler.javac.LocalJava.type" id="sbt.compiler.javac.LocalJava">LocalJava</a> <a href="#sbt.compiler.javac.LocalJava" title="sbt.compiler.javac.LocalJava.type" class="delimiter">{</a>
  <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">val</span> <a title="String" id="sbt.compiler.javac.LocalJava.javadocClass">javadocClass</a> = <span title="String(&quot;com.sun.tools.javadoc.Main&quot;)" class="string">&quot;com.sun.tools.javadoc.Main&quot;</span>

  <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">def</span> <a title="=&gt; Option[java.lang.reflect.Method]" id="sbt.compiler.javac.LocalJava.javadocMethod">javadocMethod</a> =
    <span class="keyword">try</span> <span class="delimiter">{</span>
      <span title="(x: java.lang.reflect.Method)Option[java.lang.reflect.Method]">Option</span><span class="delimiter">(</span><span title="Class.type">Class</span>.<span title="(x$1: String)Class[_]">forName</span><span class="delimiter">(</span><a href="#sbt.compiler.javac.LocalJava.javadocClass" title="String">javadocClass</a><span class="delimiter">)</span>.<span title="(x$1: String, x$2: &lt;repeated...&gt;[Class[_]])java.lang.reflect.Method">getDeclaredMethod</span><span class="delimiter">(</span><span title="String(&quot;execute&quot;)" class="string">&quot;execute&quot;</span>, classOf<span title="Class[String](classOf[java.lang.String])" class="delimiter">[</span>String<span class="delimiter">]</span>, classOf<span title="Class[java.io.PrintWriter](classOf[java.io.PrintWriter])" class="delimiter">[</span>PrintWriter<span class="delimiter">]</span>, classOf<span title="Class[java.io.PrintWriter](classOf[java.io.PrintWriter])" class="delimiter">[</span>PrintWriter<span class="delimiter">]</span>, classOf<span title="Class[java.io.PrintWriter](classOf[java.io.PrintWriter])" class="delimiter">[</span>PrintWriter<span class="delimiter">]</span>, classOf<span title="Class[String](classOf[java.lang.String])" class="delimiter">[</span>String<span class="delimiter">]</span>, classOf<span title="Class[Array[String]](classOf[[Ljava.lang.String;])" class="delimiter">[</span>Array<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a title="Throwable" id="sbt.compiler.javac.LocalJava.javadocMethod.e">e</a> @ <span class="delimiter">(</span>_: <span title="ClassNotFoundException">ClassNotFoundException</span> | _: <span title="NoSuchMethodException">NoSuchMethodException</span><span class="delimiter">)</span> =&gt; <span title="None.type">None</span>
    <span class="delimiter">}</span>

  <span class="comment">/** True if we can call a forked Javadoc. */</span>
  <span class="keyword">def</span> <a title="=&gt; Boolean" id="sbt.compiler.javac.LocalJava.hasLocalJavadoc">hasLocalJavadoc</a>: <span title="Boolean">Boolean</span> = <a href="#sbt.compiler.javac.LocalJava.javadocMethod" title="=&gt; Option[java.lang.reflect.Method]">javadocMethod</a>.<span title="=&gt; Boolean">isDefined</span>

  <span class="comment">/** A mechanism to call the javadoc tool via reflection. */</span>
  <span class="keyword">private</span><span class="delimiter">[</span>javac<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(args: Array[String], err: java.io.PrintWriter, warn: java.io.PrintWriter, notice: java.io.PrintWriter)Int" id="sbt.compiler.javac.LocalJava.unsafeJavadoc">unsafeJavadoc</a><span class="delimiter">(</span><a title="Array[String]" id="sbt.compiler.javac.LocalJava.unsafeJavadoc.args">args</a>: <span title="Array[String]">Array</span><span class="delimiter">[</span>String<span class="delimiter">]</span>, <a title="java.io.PrintWriter" id="sbt.compiler.javac.LocalJava.unsafeJavadoc.err">err</a>: <span title="java.io.PrintWriter">PrintWriter</span>, <a title="java.io.PrintWriter" id="sbt.compiler.javac.LocalJava.unsafeJavadoc.warn">warn</a>: <span title="java.io.PrintWriter">PrintWriter</span>, <a title="java.io.PrintWriter" id="sbt.compiler.javac.LocalJava.unsafeJavadoc.notice">notice</a>: <span title="java.io.PrintWriter">PrintWriter</span><span class="delimiter">)</span>: <span title="Int">Int</span> = <span class="delimiter">{</span>
    <a href="#sbt.compiler.javac.LocalJava.javadocMethod" title="=&gt; Option[java.lang.reflect.Method]">javadocMethod</a> <span title="Int" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> Some<span class="delimiter">(</span><a title="java.lang.reflect.Method" id="sbt.compiler.javac.LocalJava.unsafeJavadoc.m">m</a><span class="delimiter">)</span> =&gt;
        <span title="System.type">System</span>.<span title="java.io.PrintStream">err</span>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;Running javadoc tool!&quot;)" class="string">&quot;Running javadoc tool!&quot;</span><span class="delimiter">)</span>
        <a href="#sbt.compiler.javac.LocalJava.unsafeJavadoc.m" title="java.lang.reflect.Method">m</a>.<span title="(x$1: Any, x$2: &lt;repeated...&gt;[Object])Object">invoke</span><span class="delimiter">(</span><span title="Null(null)" class="keyword">null</span>, <span title="String(&quot;javadoc&quot;)" class="string">&quot;javadoc&quot;</span>, <a href="#sbt.compiler.javac.LocalJava.unsafeJavadoc.err" title="java.io.PrintWriter">err</a>, <a href="#sbt.compiler.javac.LocalJava.unsafeJavadoc.warn" title="java.io.PrintWriter">warn</a>, <a href="#sbt.compiler.javac.LocalJava.unsafeJavadoc.notice" title="java.io.PrintWriter">notice</a>, <span title="String(&quot;com.sun.tools.doclets.standard.Standard&quot;)" class="string">&quot;com.sun.tools.doclets.standard.Standard&quot;</span>, <a href="#sbt.compiler.javac.LocalJava.unsafeJavadoc.args" title="Array[String]">args</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Integer" class="delimiter">[</span>java.lang.<span title="Integer">Integer</span><span class="delimiter">]</span>.<span title="()Int">intValue</span>
      <span class="keyword">case</span> _ =&gt;
        <span title="System.type">System</span>.<span title="java.io.PrintStream">err</span>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;Unable to reflectively invoke javadoc, cannot find it on the current classloader!&quot;)" class="string">&quot;Unable to reflectively invoke javadoc, cannot find it on the current classloader!&quot;</span><span class="delimiter">)</span>
        -<span title="Int(-1)" class="int">1</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>
<span class="comment">/** Implementation of javadoc tool which attempts to run it locally (in-class). */</span>
<span title="AnyRef" class="keyword">final</span> <span class="keyword">class</span> <a title="class LocalJavadoc extends AnyRef with sbt.compiler.javac.Javadoc" id="sbt.compiler.javac;LocalJavadoc">LocalJavadoc</a><a href="#sbt.compiler.javac;LocalJavadoc" title="sbt.compiler.javac.LocalJavadoc" class="delimiter">(</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="JavaCompiler.scala.html#sbt.compiler.javac;Javadoc" title="sbt.compiler.javac.Javadoc">Javadoc</a> <span class="delimiter">{</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(sources: Seq[java.io.File], options: Seq[String])(implicit log: sbt.Logger, implicit reporter: xsbti.Reporter)Boolean" id="sbt.compiler.javac;LocalJavadoc.run">run</a><span class="delimiter">(</span><a title="Seq[java.io.File]" id="sbt.compiler.javac;LocalJavadoc.run.sources">sources</a>: <span title="Seq[java.io.File]">Seq</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="Seq[String]" id="sbt.compiler.javac;LocalJavadoc.run.options">options</a>: <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="sbt.Logger" id="sbt.compiler.javac;LocalJavadoc.run.log">log</a>: <a href="../../Logger.scala.html#sbt;Logger" title="sbt.Logger">Logger</a>, <a title="xsbti.Reporter" id="sbt.compiler.javac;LocalJavadoc.run.reporter">reporter</a>: <a href="../../../xsbti/Reporter.java.html#xsbti;Reporter" title="xsbti.Reporter">Reporter</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="java.io.File" id="sbt.compiler.javac;LocalJavadoc.run.cwd">cwd</a> = <span title="java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><span title="java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><span title="String(&quot;.&quot;)" class="string">&quot;.&quot;</span><span class="delimiter">)</span>.<span title="()String">getAbsolutePath</span><span class="delimiter">)</span>.<span title="()java.io.File">getCanonicalFile</span>
    <span class="keyword">val</span> <a href="#sbt.compiler.javac;LocalJavadoc.run.jArgs" title="(Seq[String], Seq[String])" class="delimiter">(</a><a href="#sbt.compiler.javac;LocalJavadoc.run.x$2" title="Seq[String]" id="sbt.compiler.javac;LocalJavadoc.run.jArgs">jArgs</a>, <a href="#sbt.compiler.javac;LocalJavadoc.run.x$2" title="Seq[String]" id="sbt.compiler.javac;LocalJavadoc.run.nonJArgs">nonJArgs</a><span class="delimiter">)</span> = <a href="#sbt.compiler.javac;LocalJavadoc.run.options" title="Seq[String]">options</a>.<span title="(p: String =&gt; Boolean)(Seq[String], Seq[String])">partition</span><span title="(Seq[String], Seq[String]) @unchecked" class="delimiter">(</span><a href="#sbt.compiler.javac;LocalJavadoc.run.x$2.$anonfun.x$1" title="String">_</a>.<span title="(x$1: String)Boolean">startsWith</span><span class="delimiter">(</span><span title="String(&quot;-J&quot;)" class="string">&quot;-J&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Seq[String]" id="sbt.compiler.javac;LocalJavadoc.run.allArguments">allArguments</a> = <a href="#sbt.compiler.javac;LocalJavadoc.run.nonJArgs" title="Seq[String]">nonJArgs</a> <span title="(that: scala.collection.GenTraversableOnce[String])(implicit bf: scala.collection.generic.CanBuildFrom[Seq[String],String,Seq[String]])Seq[String]">++</span> <a href="#sbt.compiler.javac;LocalJavadoc.run.sources" title="Seq[java.io.File]">sources</a>.<span title="(f: java.io.File =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[java.io.File],String,Seq[String]])Seq[String]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,String,Seq[String]]" class="delimiter">(</span><a href="#sbt.compiler.javac;LocalJavadoc.run.allArguments.$anonfun.x$3" title="java.io.File">_</a>.<span title="()String">getAbsolutePath</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="sbt.compiler.javac.JavacLogger" id="sbt.compiler.javac;LocalJavadoc.run.javacLogger">javacLogger</a> = <span title="sbt.compiler.javac.JavacLogger" class="keyword">new</span> <a href="JavacProcessLogger.scala.html#sbt.compiler.javac;JavacLogger" title="sbt.compiler.javac.JavacLogger">JavacLogger</a><span class="delimiter">(</span><a href="#sbt.compiler.javac;LocalJavadoc.run.log" title="sbt.Logger">log</a>, <a href="#sbt.compiler.javac;LocalJavadoc.run.reporter" title="xsbti.Reporter">reporter</a>, <a href="#sbt.compiler.javac;LocalJavadoc.run.cwd" title="java.io.File">cwd</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="java.io.PrintWriter" id="sbt.compiler.javac;LocalJavadoc.run.warnOrError">warnOrError</a> = <span title="java.io.PrintWriter" class="keyword">new</span> <span title="java.io.PrintWriter">PrintWriter</span><span class="delimiter">(</span><a href="ProcessLoggerWriter.scala.html#sbt.compiler.javac.ProcessLoggerWriter.<init>$default$3" title="sbt.compiler.javac.ProcessLoggerWriter" class="keyword">new</a> <a href="ProcessLoggerWriter.scala.html#sbt.compiler.javac;ProcessLoggerWriter" title="sbt.compiler.javac.ProcessLoggerWriter">ProcessLoggerWriter</a><span class="delimiter">(</span><a href="#sbt.compiler.javac;LocalJavadoc.run.javacLogger" title="sbt.compiler.javac.JavacLogger">javacLogger</a>, <a href="../../Level.scala.html#sbt.Level" title="sbt.Level.type">Level</a>.<a href="../../Level.scala.html#sbt.Level.Error" title="=&gt; sbt.Level.Value">Error</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="java.io.PrintWriter" id="sbt.compiler.javac;LocalJavadoc.run.infoWriter">infoWriter</a> = <span title="java.io.PrintWriter" class="keyword">new</span> <span title="java.io.PrintWriter">PrintWriter</span><span class="delimiter">(</span><a href="ProcessLoggerWriter.scala.html#sbt.compiler.javac.ProcessLoggerWriter.<init>$default$3" title="sbt.compiler.javac.ProcessLoggerWriter" class="keyword">new</a> <a href="ProcessLoggerWriter.scala.html#sbt.compiler.javac;ProcessLoggerWriter" title="sbt.compiler.javac.ProcessLoggerWriter">ProcessLoggerWriter</a><span class="delimiter">(</span><a href="#sbt.compiler.javac;LocalJavadoc.run.javacLogger" title="sbt.compiler.javac.JavacLogger">javacLogger</a>, <a href="../../Level.scala.html#sbt.Level" title="sbt.Level.type">Level</a>.<a href="../../Level.scala.html#sbt.Level.Info" title="=&gt; sbt.Level.Value">Info</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">var</span> <a title="Int" id="sbt.compiler.javac;LocalJavadoc.run.exitCode">exitCode</a> = -<span title="Int(-1)" class="int">1</span>
    <span class="keyword">try</span> <span class="delimiter">{</span>
      <a href="#sbt.compiler.javac;LocalJavadoc.run.exitCode" title="Int">exitCode</a> = <a href="#sbt.compiler.javac.LocalJava" title="sbt.compiler.javac.LocalJava.type">LocalJava</a>.<a href="#sbt.compiler.javac.LocalJava.unsafeJavadoc" title="(args: Array[String], err: java.io.PrintWriter, warn: java.io.PrintWriter, notice: java.io.PrintWriter)Int">unsafeJavadoc</a><span class="delimiter">(</span><a href="#sbt.compiler.javac;LocalJavadoc.run.allArguments" title="Seq[String]">allArguments</a>.<span title="(implicit evidence$1: scala.reflect.ClassTag[String])Array[String]">toArray</span>, <a href="#sbt.compiler.javac;LocalJavadoc.run.warnOrError" title="java.io.PrintWriter">warnOrError</a>, <a href="#sbt.compiler.javac;LocalJavadoc.run.warnOrError" title="java.io.PrintWriter">warnOrError</a>, <a href="#sbt.compiler.javac;LocalJavadoc.run.infoWriter" title="java.io.PrintWriter">infoWriter</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">finally</span> <span class="delimiter">{</span>
      <a href="#sbt.compiler.javac;LocalJavadoc.run.warnOrError" title="java.io.PrintWriter">warnOrError</a>.<span title="()Unit">close</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#sbt.compiler.javac;LocalJavadoc.run.infoWriter" title="java.io.PrintWriter">infoWriter</a>.<span title="()Unit">close</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#sbt.compiler.javac;LocalJavadoc.run.javacLogger" title="sbt.compiler.javac.JavacLogger">javacLogger</a>.<a href="JavacProcessLogger.scala.html#sbt.compiler.javac;JavacLogger.flush" title="(exitCode: Int)Unit">flush</a><span class="delimiter">(</span><a href="#sbt.compiler.javac;LocalJavadoc.run.exitCode" title="Int">exitCode</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span class="comment">// We return true or false, depending on success.</span>
    <a href="#sbt.compiler.javac;LocalJavadoc.run.exitCode" title="Int">exitCode</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="comment">/** An implementation of compiling java which delegates to the JVM resident java compiler. */</span>
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class LocalJavaCompiler extends AnyRef with sbt.compiler.javac.JavaCompiler" id="sbt.compiler.javac;LocalJavaCompiler">LocalJavaCompiler</a><a href="#sbt.compiler.javac;LocalJavaCompiler" title="sbt.compiler.javac.LocalJavaCompiler" class="delimiter">(</a><a title="javax.tools.JavaCompiler" id="sbt.compiler.javac;LocalJavaCompiler.compiler">compiler</a>: javax.tools.<span title="javax.tools.JavaCompiler">JavaCompiler</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="JavaCompiler.scala.html#sbt.compiler.javac;JavaCompiler" title="sbt.compiler.javac.JavaCompiler">JavaCompiler</a> <span class="delimiter">{</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(sources: Seq[java.io.File], options: Seq[String])(implicit log: sbt.Logger, implicit reporter: xsbti.Reporter)Boolean" id="sbt.compiler.javac;LocalJavaCompiler.run">run</a><span class="delimiter">(</span><a title="Seq[java.io.File]" id="sbt.compiler.javac;LocalJavaCompiler.run.sources">sources</a>: <span title="Seq[java.io.File]">Seq</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="Seq[String]" id="sbt.compiler.javac;LocalJavaCompiler.run.options">options</a>: <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="sbt.Logger" id="sbt.compiler.javac;LocalJavaCompiler.run.log">log</a>: <a href="../../Logger.scala.html#sbt;Logger" title="sbt.Logger">Logger</a>, <a title="xsbti.Reporter" id="sbt.compiler.javac;LocalJavaCompiler.run.reporter">reporter</a>: <a href="../../../xsbti/Reporter.java.html#xsbti;Reporter" title="xsbti.Reporter">Reporter</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span class="delimiter">{</span>
    <span class="keyword">import</span> collection.<span title="scala.collection.JavaConverters.type">JavaConverters</span>._
    <span class="keyword">val</span> <a title="sbt.LoggerWriter" id="sbt.compiler.javac;LocalJavaCompiler.run.logger">logger</a> = <a href="../../LoggerWriter.scala.html#sbt;LoggerWriter.<init>(05e861c7eb)" title="(delegate: sbt.Logger)sbt.LoggerWriter" class="keyword">new</a> <a href="../../LoggerWriter.scala.html#sbt;LoggerWriter" title="sbt.LoggerWriter">LoggerWriter</a><span class="delimiter">(</span><a href="#sbt.compiler.javac;LocalJavaCompiler.run.log" title="sbt.Logger">log</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="java.io.PrintWriter" id="sbt.compiler.javac;LocalJavaCompiler.run.logWriter">logWriter</a> = <span title="java.io.PrintWriter" class="keyword">new</span> <span title="java.io.PrintWriter">PrintWriter</span><span class="delimiter">(</span><a href="#sbt.compiler.javac;LocalJavaCompiler.run.logger" title="sbt.LoggerWriter">logger</a><span class="delimiter">)</span>
    <a href="#sbt.compiler.javac;LocalJavaCompiler.run.log" title="sbt.Logger">log</a>.<a href="../../Logger.scala.html#sbt;Logger.debug(83d3728a3c)" title="(message: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="String(&quot;Attempting to call &quot;)" class="string">&quot;Attempting to call &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#sbt.compiler.javac;LocalJavaCompiler.compiler" title="javax.tools.JavaCompiler">compiler</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; directly...&quot;)" class="string">&quot; directly...&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="sbt.compiler.javac.DiagnosticsReporter" id="sbt.compiler.javac;LocalJavaCompiler.run.diagnostics">diagnostics</a> = <span title="sbt.compiler.javac.DiagnosticsReporter" class="keyword">new</span> <a href="DiagnosticsReporter.scala.html#sbt.compiler.javac;DiagnosticsReporter" title="sbt.compiler.javac.DiagnosticsReporter">DiagnosticsReporter</a><span class="delimiter">(</span><a href="#sbt.compiler.javac;LocalJavaCompiler.run.reporter" title="xsbti.Reporter">reporter</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="javax.tools.StandardJavaFileManager" id="sbt.compiler.javac;LocalJavaCompiler.run.fileManager">fileManager</a> = <a href="#sbt.compiler.javac;LocalJavaCompiler.compiler" title="javax.tools.JavaCompiler">compiler</a>.<span title="(x$1: javax.tools.DiagnosticListener[_ &gt;: javax.tools.JavaFileObject], x$2: java.util.Locale, x$3: java.nio.charset.Charset)javax.tools.StandardJavaFileManager">getStandardFileManager</span><span class="delimiter">(</span><a href="#sbt.compiler.javac;LocalJavaCompiler.run.diagnostics" title="sbt.compiler.javac.DiagnosticsReporter">diagnostics</a>, <span title="Null(null)" class="keyword">null</span>, <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Iterable[_ &lt;: javax.tools.JavaFileObject]" id="sbt.compiler.javac;LocalJavaCompiler.run.jfiles">jfiles</a> = <a href="#sbt.compiler.javac;LocalJavaCompiler.run.fileManager" title="javax.tools.StandardJavaFileManager">fileManager</a>.<span title="(x$1: Iterable[_ &lt;: java.io.File])Iterable[_ &lt;: javax.tools.JavaFileObject]">getJavaFileObjectsFromFiles</span><span class="delimiter">(</span><a href="#sbt.compiler.javac;LocalJavaCompiler.run.sources" title="(b: Seq[java.io.File])scala.collection.convert.Decorators.AsJava[java.util.List[java.io.File]]">sources</a>.<span title="=&gt; java.util.List[java.io.File]">asJava</span><span class="delimiter">)</span>

    <span class="comment">// Local Java compiler doesn't accept `-J&lt;flag&gt;` options. We emit a warning if we find</span>
    <span class="comment">// such options and don't pass them to the compiler.</span>
    <span class="keyword">val</span> <a href="#sbt.compiler.javac;LocalJavaCompiler.run.invalidOptions" title="(Seq[String], Seq[String])" class="delimiter">(</a><a href="#sbt.compiler.javac;LocalJavaCompiler.run.x$5" title="Seq[String]" id="sbt.compiler.javac;LocalJavaCompiler.run.invalidOptions">invalidOptions</a>, <a href="#sbt.compiler.javac;LocalJavaCompiler.run.x$5" title="Seq[String]" id="sbt.compiler.javac;LocalJavaCompiler.run.cleanedOptions">cleanedOptions</a><span class="delimiter">)</span> = <a href="#sbt.compiler.javac;LocalJavaCompiler.run.options" title="Seq[String]">options</a> <span title="(p: String =&gt; Boolean)(Seq[String], Seq[String])">partition</span> <span class="delimiter">(</span><a href="#sbt.compiler.javac;LocalJavaCompiler.run.x$5.$anonfun.x$4" title="String">_</a> <span title="(x$1: String)Boolean">startsWith</span> <span title="String(&quot;-J&quot;)" class="string">&quot;-J&quot;</span><span class="delimiter">)</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#sbt.compiler.javac;LocalJavaCompiler.run.invalidOptions" title="Seq[String]">invalidOptions</a>.<span title="=&gt; Boolean">nonEmpty</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#sbt.compiler.javac;LocalJavaCompiler.run.log" title="sbt.Logger">log</a>.<a href="../../Logger.scala.html#sbt;Logger.warn(83d3728a3c)" title="(message: =&gt; String)Unit">warn</a><span class="delimiter">(</span><span title="String(&quot;Javac is running in \'local\' mode. These flags have been removed:&quot;)" class="string">&quot;Javac is running in 'local' mode. These flags have been removed:&quot;</span><span class="delimiter">)</span>
      <a href="#sbt.compiler.javac;LocalJavaCompiler.run.log" title="sbt.Logger">log</a>.<a href="../../Logger.scala.html#sbt;Logger.warn(83d3728a3c)" title="(message: =&gt; String)Unit">warn</a><span class="delimiter">(</span><a href="#sbt.compiler.javac;LocalJavaCompiler.run.invalidOptions" title="Seq[String]">invalidOptions</a>.<span title="(start: String, sep: String, end: String)String">mkString</span><span class="delimiter">(</span><span title="String(&quot;\t&quot;)" class="string">&quot;\t&quot;</span>, <span title="String(&quot;, &quot;)" class="string">&quot;, &quot;</span>, <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span class="keyword">val</span> <a title="Boolean" id="sbt.compiler.javac;LocalJavaCompiler.run.success">success</a> = <a href="#sbt.compiler.javac;LocalJavaCompiler.compiler" title="javax.tools.JavaCompiler">compiler</a>.<span title="(x$1: java.io.Writer, x$2: javax.tools.JavaFileManager, x$3: javax.tools.DiagnosticListener[_ &gt;: javax.tools.JavaFileObject], x$4: Iterable[String], x$5: Iterable[String], x$6: Iterable[_ &lt;: javax.tools.JavaFileObject])javax.tools.JavaCompiler.CompilationTask">getTask</span><span class="delimiter">(</span><a href="#sbt.compiler.javac;LocalJavaCompiler.run.logWriter" title="java.io.PrintWriter">logWriter</a>, <a href="#sbt.compiler.javac;LocalJavaCompiler.run.fileManager" title="javax.tools.StandardJavaFileManager">fileManager</a>, <a href="#sbt.compiler.javac;LocalJavaCompiler.run.diagnostics" title="sbt.compiler.javac.DiagnosticsReporter">diagnostics</a>, <a href="#sbt.compiler.javac;LocalJavaCompiler.run.cleanedOptions" title="(b: Seq[String])scala.collection.convert.Decorators.AsJava[java.util.List[String]]">cleanedOptions</a>.<span title="=&gt; java.util.List[String]">asJava</span>, <span title="Null(null)" class="keyword">null</span>, <a href="#sbt.compiler.javac;LocalJavaCompiler.run.jfiles" title="Iterable[_ &lt;: javax.tools.JavaFileObject]">jfiles</a><span class="delimiter">)</span>.<span title="()Boolean">call</span><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="comment">// The local compiler may report a successful compilation even though there are errors (e.g. encoding problems in the</span>
    <span class="comment">// source files). In a similar situation, command line javac reports a failed compilation. To have the local java compiler</span>
    <span class="comment">// stick to javac's behavior, we report a failed compilation if there have been errors.</span>
    <a href="#sbt.compiler.javac;LocalJavaCompiler.run.success" title="implicit scala.Predef.Boolean2boolean : (x: Boolean)Boolean">success</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span title="=&gt; Boolean">!</span><a href="#sbt.compiler.javac;LocalJavaCompiler.run.diagnostics" title="sbt.compiler.javac.DiagnosticsReporter">diagnostics</a>.<a href="DiagnosticsReporter.scala.html#sbt.compiler.javac;DiagnosticsReporter.hasErrors" title="=&gt; Boolean">hasErrors</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>
        </pre>
    </body>
</html>
